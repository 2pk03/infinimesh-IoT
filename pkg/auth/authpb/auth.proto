syntax = "proto3";

package infinimesh.auth;
option go_package = "authpb";

import "google/protobuf/wrappers.proto";

message IsAuthorizedRequest {
  string object = 1;
  string subject = 2;
  Action action = 3;
}

message IsAuthorizedResponse { google.protobuf.BoolValue decision = 1; }

message LoginRequest{
  string clientID = 1;
  string clientSecret = 2;
}
message LoginResponse{}

message CreateUserRequest{
  string name = 1;
}
message CreateUserResponse{
  string uid = 1;
}

enum Action {
  NONE = 0;
  READ = 1;
  WRITE = 2;
}

message AuthorizeRequest{
  string entity_uid = 1;
  string resource_uid = 2;
  string action = 3;
  bool inherit = 4;
}
message AuthorizeResponse{}

message SetCredentialsRequest{
  string password = 1;
}
message SetCredentialsResponse{}

service Auth {
  rpc IsAuthorized(IsAuthorizedRequest) returns (IsAuthorizedResponse);
  rpc CreateUser(CreateUserRequest) returns (CreateUserResponse);
  rpc SetCredentials(SetCredentialsRequest) returns (SetCredentialsResponse);

  rpc Login(LoginRequest) returns (LoginResponse);
  rpc Authorize(AuthorizeRequest) returns (AuthorizeResponse);
>>>>>>> clearance w/o facets
